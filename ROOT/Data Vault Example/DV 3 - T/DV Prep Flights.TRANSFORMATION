{"job":{"components":{"541474":{"id":541474,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":671,"y":221,"width":32,"height":32,"inputConnectorIDs":[541490],"outputConnectorIDs":[541484],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delayed flag"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"sched_dep\"  IS NULL OR \"sched_arr\" IS NULL\n          THEN false\n     WHEN \"actual_dep\" IS NULL OR \"actual_arr\" IS NULL\n          THEN false\n     WHEN DATEDIFF(min, TO_TIMESTAMP('20010101'||\"sched_arr\",  'YYYYMMDDHH24MI') :: timestamp(0),\n                        TO_TIMESTAMP('20010101'||\"actual_arr\", 'YYYYMMDDHH24MI') :: timestamp(0)) > 15\n          THEN true\n     ELSE\n          false\nEND"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541475":{"id":541475,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":362,"y":222,"width":32,"height":32,"inputConnectorIDs":[541483],"outputConnectorIDs":[541488],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add dup counter"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROW_NUMBER() OVER (PARTITION BY \"ux_flightnum\", \"ux_origin\", \"ux_dest\", \"ux_date\", \"ux_deptime\"\n                   ORDER BY \"ux_flightnum\")"},"2":{"slot":2,"type":"STRING","value":"dup_seq"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541476":{"id":541476,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":76,"y":222,"width":32,"height":32,"inputConnectorIDs":[541486],"outputConnectorIDs":[541489],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Must have a business key"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"ux_flightnum\" IS NOT NULL\n      AND \"ux_origin\" IS NOT NULL\n      AND \"ux_dest\" IS NOT NULL\n      AND \"ux_date\" IS NOT NULL\n      AND \"ux_deptime\" IS NOT NULL\n     THEN 1\n     ELSE 0\nEND"},"2":{"slot":2,"type":"STRING","value":"dq_indicator"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541477":{"id":541477,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":859,"y":226,"width":32,"height":32,"inputConnectorIDs":[541484],"outputConnectorIDs":[541487],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ux_flightnum"},"2":{"slot":2,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ux_origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ux_dest"},"2":{"slot":2,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ux_date"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ux_deptime"},"2":{"slot":2,"type":"STRING","value":"deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"plane_tailnum"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541478":{"id":541478,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":497,"y":225,"width":32,"height":32,"inputConnectorIDs":[541488],"outputConnectorIDs":[541490],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove dups"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dup_seq"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541479":{"id":541479,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-211,"y":231,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[541485],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"year"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"month"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dayofmonth"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"crsdeptime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrtime"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"crsarrtime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541480":{"id":541480,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-71,"y":221,"width":32,"height":32,"inputConnectorIDs":[541485],"outputConnectorIDs":[541486],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate derived fields"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(\"flightnum\") :: varchar(4)"},"2":{"slot":2,"type":"STRING","value":"ux_flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"origin\" :: varchar(3)"},"2":{"slot":2,"type":"STRING","value":"ux_origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"dest\" :: varchar(3)"},"2":{"slot":2,"type":"STRING","value":"ux_dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TO_DATE( TO_CHAR(\"year\", 'FM0000') || TO_CHAR(\"month\", 'FM00') || TO_CHAR(\"dayofmonth\", 'FM00'), 'YYYYMMDD')"},"2":{"slot":2,"type":"STRING","value":"ux_date"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(COALESCE(\"crsdeptime\", \"deptime\"), 'FM0000') :: varchar(4)"},"2":{"slot":2,"type":"STRING","value":"ux_deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"NULLIF(TRIM(\"tailnum\"), '') :: varchar(6)"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"crsdeptime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"deptime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"crsarrtime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"arrtime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541481":{"id":541481,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1001,"y":224,"width":32,"height":32,"inputConnectorIDs":[541487],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite tmp_flight_data"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Key"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"541482":{"id":541482,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":211,"y":224,"width":32,"height":32,"inputConnectorIDs":[541489],"outputConnectorIDs":[541483],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter valid only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dq_indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"541483":{"id":541483,"sourceID":541482,"targetID":541475},"541484":{"id":541484,"sourceID":541474,"targetID":541477},"541485":{"id":541485,"sourceID":541479,"targetID":541480},"541486":{"id":541486,"sourceID":541480,"targetID":541476},"541487":{"id":541487,"sourceID":541477,"targetID":541481},"541488":{"id":541488,"sourceID":541475,"targetID":541478},"541489":{"id":541489,"sourceID":541476,"targetID":541482},"541490":{"id":541490,"sourceID":541478,"targetID":541474}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"541470":{"id":541470,"x":-138,"y":154,"width":387,"height":138,"text":"Datatype cleansing and validation"},"541471":{"id":541471,"x":307,"y":155,"width":231,"height":139,"text":"De-duplicate"},"541472":{"id":541472,"x":806,"y":156,"width":272,"height":141,"text":"Rewrite temp table tmp_flight_data, since it will be used in a couple of places"},"541473":{"id":541473,"x":573,"y":155,"width":200,"height":142,"text":"Add derived fields"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DV Prep Flights","description":"","type":"TRANSFORMATION"}}