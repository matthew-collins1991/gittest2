{"job":{"components":{"538937":{"id":538937,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":671,"y":221,"width":32,"height":32,"inputConnectorIDs":[538951],"outputConnectorIDs":[538953],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delayed flag"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"sched_dep\"  IS NULL OR \"sched_arr\" IS NULL\n          THEN false\n     WHEN \"actual_dep\" IS NULL OR \"actual_arr\" IS NULL\n          THEN false\n     WHEN DATEDIFF(min, TO_TIMESTAMP('20010101'||\"sched_arr\",  'YYYYMMDDHH24MI') :: timestamp(0),\n                        TO_TIMESTAMP('20010101'||\"actual_arr\", 'YYYYMMDDHH24MI') :: timestamp(0)) > 15\n          THEN true\n     ELSE\n          false\nEND"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538938":{"id":538938,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":362,"y":222,"width":32,"height":32,"inputConnectorIDs":[538952],"outputConnectorIDs":[538949],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add dup counter"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROW_NUMBER() OVER (PARTITION BY \"ux_flightnum\", \"ux_origin\", \"ux_dest\", \"ux_date\", \"ux_deptime\"\n                   ORDER BY \"ux_flightnum\")"},"2":{"slot":2,"type":"STRING","value":"dup_seq"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538939":{"id":538939,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":76,"y":222,"width":32,"height":32,"inputConnectorIDs":[538947],"outputConnectorIDs":[538950],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Must have a business key"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"ux_flightnum\" IS NOT NULL\n      AND \"ux_origin\" IS NOT NULL\n      AND \"ux_dest\" IS NOT NULL\n      AND \"ux_date\" IS NOT NULL\n      AND \"ux_deptime\" IS NOT NULL\n     THEN 1\n     ELSE 0\nEND"},"2":{"slot":2,"type":"STRING","value":"dq_indicator"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538940":{"id":538940,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":859,"y":226,"width":32,"height":32,"inputConnectorIDs":[538953],"outputConnectorIDs":[538948],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ux_flightnum"},"2":{"slot":2,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ux_origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ux_dest"},"2":{"slot":2,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ux_date"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ux_deptime"},"2":{"slot":2,"type":"STRING","value":"deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"plane_tailnum"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538941":{"id":538941,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":497,"y":225,"width":32,"height":32,"inputConnectorIDs":[538949],"outputConnectorIDs":[538951],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove dups"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dup_seq"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538942":{"id":538942,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-211,"y":231,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[538946],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"year"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"month"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dayofmonth"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"crsdeptime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrtime"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"crsarrtime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538943":{"id":538943,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-71,"y":221,"width":32,"height":32,"inputConnectorIDs":[538946],"outputConnectorIDs":[538947],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate derived fields"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(\"flightnum\") :: varchar(4)"},"2":{"slot":2,"type":"STRING","value":"ux_flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"origin\" :: varchar(3)"},"2":{"slot":2,"type":"STRING","value":"ux_origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"dest\" :: varchar(3)"},"2":{"slot":2,"type":"STRING","value":"ux_dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TO_DATE( TO_CHAR(\"year\", 'FM0000') || TO_CHAR(\"month\", 'FM00') || TO_CHAR(\"dayofmonth\", 'FM00'), 'YYYYMMDD')"},"2":{"slot":2,"type":"STRING","value":"ux_date"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(COALESCE(\"crsdeptime\", \"deptime\"), 'FM0000') :: varchar(4)"},"2":{"slot":2,"type":"STRING","value":"ux_deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"NULLIF(TRIM(\"tailnum\"), '') :: varchar(6)"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"crsdeptime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"deptime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"crsarrtime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"arrtime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538944":{"id":538944,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1001,"y":224,"width":32,"height":32,"inputConnectorIDs":[538948],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite tmp_flight_data"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Key"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"538945":{"id":538945,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":211,"y":224,"width":32,"height":32,"inputConnectorIDs":[538950],"outputConnectorIDs":[538952],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter valid only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dq_indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"538952":{"id":538952,"sourceID":538945,"targetID":538938},"538953":{"id":538953,"sourceID":538937,"targetID":538940},"538946":{"id":538946,"sourceID":538942,"targetID":538943},"538947":{"id":538947,"sourceID":538943,"targetID":538939},"538948":{"id":538948,"sourceID":538940,"targetID":538944},"538949":{"id":538949,"sourceID":538938,"targetID":538941},"538950":{"id":538950,"sourceID":538939,"targetID":538945},"538951":{"id":538951,"sourceID":538941,"targetID":538937}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"538933":{"id":538933,"x":-138,"y":154,"width":387,"height":138,"text":"Datatype cleansing and validation"},"538934":{"id":538934,"x":307,"y":155,"width":231,"height":139,"text":"De-duplicate"},"538935":{"id":538935,"x":806,"y":156,"width":272,"height":141,"text":"Rewrite temp table tmp_flight_data, since it will be used in a couple of places"},"538936":{"id":538936,"x":573,"y":155,"width":200,"height":142,"text":"Add derived fields"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DV Prep Flights","description":"","type":"TRANSFORMATION"}}