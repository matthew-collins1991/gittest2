{"job":{"components":{"540243":{"id":540243,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":671,"y":221,"width":32,"height":32,"inputConnectorIDs":[540259],"outputConnectorIDs":[540253],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delayed flag"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"sched_dep\"  IS NULL OR \"sched_arr\" IS NULL\n          THEN false\n     WHEN \"actual_dep\" IS NULL OR \"actual_arr\" IS NULL\n          THEN false\n     WHEN DATEDIFF(min, TO_TIMESTAMP('20010101'||\"sched_arr\",  'YYYYMMDDHH24MI') :: timestamp(0),\n                        TO_TIMESTAMP('20010101'||\"actual_arr\", 'YYYYMMDDHH24MI') :: timestamp(0)) > 15\n          THEN true\n     ELSE\n          false\nEND"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540244":{"id":540244,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":362,"y":222,"width":32,"height":32,"inputConnectorIDs":[540252],"outputConnectorIDs":[540257],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add dup counter"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROW_NUMBER() OVER (PARTITION BY \"ux_flightnum\", \"ux_origin\", \"ux_dest\", \"ux_date\", \"ux_deptime\"\n                   ORDER BY \"ux_flightnum\")"},"2":{"slot":2,"type":"STRING","value":"dup_seq"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540245":{"id":540245,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":76,"y":222,"width":32,"height":32,"inputConnectorIDs":[540255],"outputConnectorIDs":[540258],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Must have a business key"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"ux_flightnum\" IS NOT NULL\n      AND \"ux_origin\" IS NOT NULL\n      AND \"ux_dest\" IS NOT NULL\n      AND \"ux_date\" IS NOT NULL\n      AND \"ux_deptime\" IS NOT NULL\n     THEN 1\n     ELSE 0\nEND"},"2":{"slot":2,"type":"STRING","value":"dq_indicator"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540246":{"id":540246,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":859,"y":226,"width":32,"height":32,"inputConnectorIDs":[540253],"outputConnectorIDs":[540256],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ux_flightnum"},"2":{"slot":2,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ux_origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ux_dest"},"2":{"slot":2,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ux_date"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ux_deptime"},"2":{"slot":2,"type":"STRING","value":"deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"plane_tailnum"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540247":{"id":540247,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":497,"y":225,"width":32,"height":32,"inputConnectorIDs":[540257],"outputConnectorIDs":[540259],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove dups"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dup_seq"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540248":{"id":540248,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-211,"y":231,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[540254],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"year"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"month"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dayofmonth"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"crsdeptime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrtime"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"crsarrtime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540249":{"id":540249,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-71,"y":221,"width":32,"height":32,"inputConnectorIDs":[540254],"outputConnectorIDs":[540255],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate derived fields"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(\"flightnum\") :: varchar(4)"},"2":{"slot":2,"type":"STRING","value":"ux_flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"origin\" :: varchar(3)"},"2":{"slot":2,"type":"STRING","value":"ux_origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"dest\" :: varchar(3)"},"2":{"slot":2,"type":"STRING","value":"ux_dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TO_DATE( TO_CHAR(\"year\", 'FM0000') || TO_CHAR(\"month\", 'FM00') || TO_CHAR(\"dayofmonth\", 'FM00'), 'YYYYMMDD')"},"2":{"slot":2,"type":"STRING","value":"ux_date"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(COALESCE(\"crsdeptime\", \"deptime\"), 'FM0000') :: varchar(4)"},"2":{"slot":2,"type":"STRING","value":"ux_deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"NULLIF(TRIM(\"tailnum\"), '') :: varchar(6)"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"crsdeptime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"deptime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"crsarrtime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(\"arrtime\", 'FM0000') :: char(4)"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540250":{"id":540250,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1001,"y":224,"width":32,"height":32,"inputConnectorIDs":[540256],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite tmp_flight_data"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"3":{"slot":3,"name":"Table Sort Key","elements":{},"visible":true},"4":{"slot":4,"name":"Table Distribution Style","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Key"}}}},"visible":true},"5":{"slot":5,"name":"Table Distribution Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Sort Key Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Compound"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"540251":{"id":540251,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":211,"y":224,"width":32,"height":32,"inputConnectorIDs":[540258],"outputConnectorIDs":[540252],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter valid only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dq_indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"540252":{"id":540252,"sourceID":540251,"targetID":540244},"540253":{"id":540253,"sourceID":540243,"targetID":540246},"540254":{"id":540254,"sourceID":540248,"targetID":540249},"540255":{"id":540255,"sourceID":540249,"targetID":540245},"540256":{"id":540256,"sourceID":540246,"targetID":540250},"540257":{"id":540257,"sourceID":540244,"targetID":540247},"540258":{"id":540258,"sourceID":540245,"targetID":540251},"540259":{"id":540259,"sourceID":540247,"targetID":540243}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"540239":{"id":540239,"x":-138,"y":154,"width":387,"height":138,"text":"Datatype cleansing and validation"},"540240":{"id":540240,"x":307,"y":155,"width":231,"height":139,"text":"De-duplicate"},"540241":{"id":540241,"x":806,"y":156,"width":272,"height":141,"text":"Rewrite temp table tmp_flight_data, since it will be used in a couple of places"},"540242":{"id":540242,"x":573,"y":155,"width":200,"height":142,"text":"Add derived fields"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DV Prep Flights","description":"","type":"TRANSFORMATION"}}